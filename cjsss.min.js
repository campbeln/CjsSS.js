/*
CjsSS.js v0.5g (kk) http://opensourcetaekwondo.com/cjsss
(c) 2014 Nick Campbell cjsssdev@gmail.com
License: MIT
Thanks jscompress.com!
*/
(function(e,t,n,r,i,s){"use strict";function v(e,n,r,i){function f(){switch(s.scope.substr(0,1)){case"#":{s=l(s);delete h[a].run;delete h[a].evaler;break};case"l":case"u":{delete h[a].parent;h[a].run=-1;h[a].evaler=c.evalFactory[s.scope]();break};default:{delete h[a].parent;h[a].run=1;h[a].evaler=c.evalFactory[s.scope]()}}}function l(n){var i,s=n.scope.substring(1),o=h[s];if(!o){i=t.getElementById(s);if(i){if(n.async&&e.tagName.toLowerCase()==="link"){c.warn("Orphaned element (asynchronously loaded LINK tags designated as parent scopes must be loaded prior to their children):",e)}else{i=c.process(i,r.oPro);o=h[s]}}else{c.warn("Orphaned element (unable to locate parent ID '#"+s+"'):",e)}}if(o&&o!==h[a].parent){h[a].parent=o;if(c.is.arr(i)){r.r$e=r.r$e.concat(i)}n=c.getOptions(r.oPro,h[a])}return n}var s,o,u,a=e.id;if(!h[a]){u=i.match(/^\s*\/\*cjsss\(\{(.*)?\}\)\*\//i);h[a]={scripts:n?c.getScripts(i,e):null,id:a};if(r.oA||u){o=c.evalFactory[r.oPre.optionScope]();if(r.oA){h[a].aOptions=o(r.oA)}if(n&&u&&u[1]){h[a].cOptions=o("{"+u[1]+"}")}}s=c.getOptions(r.oPro,h[a]);h[a].css=i.replace(new RegExp("/\\*"+c.escapeRegex(s.d1),"g"),s.d1).replace(new RegExp(c.escapeRegex(s.d2)+"\\*/","g"),s.d2);f()}else{s=c.getOptions(r.oPro,h[a]);if(!n&&s.rescope===true){f()}}return s}var o=false,u="cjsss",a=/<script.*?>([\s\S]*?)<\/script>/gi,f={version:"v0.5g (kk)",options:{selector:"["+u+"],[data-"+u+"],LINK[type='text/"+u+"'],STYLE[type='text/"+u+"']",optionScope:"json",scope:"isolated",expose:true,async:true,rescope:false,d1:"[[",d2:"]]"},data:{services:{},inject:{},cache:{}},services:{},process:function(){f.services.process.apply(this,arguments)},inject:function(){f.services.inject.apply(this,arguments)}},l=f.options,c=f.services,h=f.data.cache,p=f.data.inject,d=Object.prototype.toString;c.autorun=function(){if(l.selector){c.process(l.selector)}else{c.expose()}};c.dom=e.jQuery||function(e){try{return t.querySelectorAll(e)}catch(n){return[]}};c.escapeRegex=function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")};c.expose=function(){if(!o){o=true;f=e[u]=c.extend(e[u],f);c.inject(u,f)}};c.extend=function(e){var t,n;e=c.is.obj(e)?e:{};for(t=1;t<arguments.length;t++){if(c.is.obj(arguments[t])){for(n in arguments[t]){if(arguments[t].hasOwnProperty(n)){e[n]=c.is.obj(arguments[t][n])?c.extend(e[n],arguments[t][n]):arguments[t][n]}}}}return e};c.get=function(e,t,n){var r=XMLHttpRequest||ActiveXObject,i;try{i=new r("MSXML2.XMLHTTP.3.0")}catch(s){}if(c.is.fn(n)){n={fn:n,arg:null}}if(i){i.onreadystatechange=function(){if(i.readyState===4){n.fn(i.status===200||i.status===0&&e.substr(0,7)==="file://",i.responseText,n.arg,i)}};i.open("GET",e,t);i.send()}else{n.fn(false,null,n.arg,i)}};c.getOptions=function(e,t){t=c.is.obj(t)?t:{};var n=t.parent||{};return c.extend({},l,n.cOptions,t.cOptions,n.aOptions,t.aOptions,e)};c.getScripts=function(e,t){var n,r,i=e.match(a)||[],s=/<[\/]?script.*?>/gi,o=/<script.*?src=['"](.*?)['"].*?>/i,u=function(e,n,r){i[r.i]=e?n:"";if(!e){c.warn("Unable to retrieve external script '"+r.src+"' for:",t)}};for(r=0;r<i.length;r++){n=o.exec(i[r]);if(n&&n[1]){c.get(n[1],false,{fn:u,arg:{i:r,src:n[1]}})}else{i[r]=i[r].replace(s,"")}}return i};c.is={str:function(e){return(typeof e==="string"||e instanceof String)&&e!==""},fn:function(e){return d.call(e)==="[object Function]"},obj:function(e){return e&&e===Object(e)&&!c.is.fn(e)},arr:function(e){return d.call(e)==="[object Array]"}};c.inject=function(e,t){var n=c.is.str(e);if(n){p[e]=t}return n};c.mixin=function(e,t,n){var r="",i=n?"\n":"";if(c.is.obj(e)){r=(t?(c.is.str(t)?t:e._selector)+" {":"")+i+c.toCss(e,i)+i+(t?"}":"")}return r};c.toCss=function(e,t){var n,r,i="";for(n in e){if(e.hasOwnProperty(n)&&n!=="_selector"){r=e[n];n=n.replace(/([A-Z])/g,"-$1").toLowerCase();n=n.indexOf("-")===0?n.substr(1):n;if(c.is.obj(r)){i+=c.toCss(r,t)}else{i+=n+":"+r+";"+t}}}return i};c.newId=function(e){var n;e=e||u+"_";do{n=Math.random().toString(36).substr(2,5)}while(t.getElementById(e+n));return e+n};c.process=function(e,n){var r,i,s,o,a,f,l=[],p=[],d=c.getOptions(n),m=function(e){return typeof this[e]!=="undefined"},g=function(e,r,i){if(e){var s=t.createElement("style");s.type="text/css";s.setAttribute(i.attr,i.$link.getAttribute(i.attr)||"");i.$link.parentNode.replaceChild(s,i.$link);s.id=i.id;c.processCSS(s,v(s,true,{oA:i.aOptions,oPre:d,oPro:n,r$e:p},r))}};if(e){if(c.is.str(e)){l=c.dom(e)}else{l=e[0]&&e.length?e:[e]}}else if(c.is.str(d.selector)){l=c.dom(d.selector)}if(d.expose){c.expose()}for(r=0;r<l.length;r++){i=l[r];i.hasAttribute=i.hasAttribute||m;s=(i.hasAttribute("data-"+u)?"data-":"")+u;o=i.getAttribute(s);a=i.id=i.id||c.newId();switch(i.tagName.toLowerCase()){case"style":{if(h[a]){f=v(i,true,{oPro:n})}else{f=v(i,true,{oA:o,oPre:d,oPro:n,r$e:p},i.innerHTML)}c.processCSS(i,f);i.type="text/css";break};case"link":{c.get(i.href,d.async,{fn:g,arg:{$link:i,attr:s,aOptions:o,id:a}});break};default:{if(h[a]){c.processCSS(i,v(i,false,{oPro:n,r$e:p}),true)}else{c.processCSS(i,v(i,false,{oA:!o||o.indexOf("{")===0?o:'{ "scope": "'+o+'" }',oPre:d,oPro:n,r$e:p},i.getAttribute("style")),true)}}}}return[].concat(l,p)};c.processCSS=function(e,t,n){function v(t){s=d[0];for(r=1;r<d.length;r++){s+=t.results[d[r].i]+d[r].s}if(n){e.setAttribute("style",s)}else{if(e.styleSheet){e.styleSheet.cssText=s}else{e.innerHTML=s}}if(t.errors.length>0){c.warn("Errors occurred processing the Javascript for: ",e,t.errors)}}var r,i,s,o,u=[],f=e.id,l=h[f].parent||h[f],d=h[f].css.replace(a,"").split(t.d1);if(l.scripts&&l.run!==0){l.run--;u=l.scripts}if(h[f].parent&&h[f].scripts&&h[f].run!==0){h[f].run--;u=u.concat(h[f].scripts)}for(r=1;r<d.length;r++){i=d[r].split(t.d2);d[r]={i:u.push(i.shift())-1,s:i.join(t.d2)}}o=l.evaler(u,p,true);if(c.is.fn(o.then)){o.then(v)}else{v(o)}};c.warn=function(e,t,n){var r=console;(r?r.warn||r.log:function(){})(u+": "+e,t,n||"")};f.data.services=c.extend({},c);if(c.is.obj(e[u])){if(c.is.fn(e[u].servicesFactory)){c.extend(c,e[u].servicesFactory(f))}c.extend(l,e[u].options)}c.evalFactory=c.evalFactory||n(e,t,c,r,i,s);c.inject("mixin",c.mixin);c.autorun()})(window,document,function(e,t,n,r,i,s){"use strict";function a(e){var t="try{return(function(g,Object){return((1,eval)('Object')===g?function(){return(1,eval)(arguments[0]);}:(window.execScript?function(){return window.execScript(arguments[0]);}:undefined));})(Object,{});}catch(e){return undefined;}";if(e){return t}else if(u===null){u=(new Function(t))()}}function f(e,t,s){return function(o,u,a){var f,l=n.is.arr(o),c=n.is.obj(u),h={js:l?o:[o],results:[],errors:[]};if(t&&c){for(f in u){if(t[f]===undefined&&u.hasOwnProperty(f)){t[f]=u[f]}}}switch(e){case r:case i:{if(!Object.keys)Object.keys=function(e){if(e!==Object(e))throw new TypeError("Object.keys called on a non-object");var t=[],n;for(n in e)if(Object.prototype.hasOwnProperty.call(e,n))t.push(n);return t}(s?e.call(t,h,0,!s&&c?{o:u,k:Object.keys(u)}:null):e(h,0,!s&&c?{o:u,k:Object.keys(u)}:null));break};default:{for(f=0;f<h.js.length;f++){try{h.results.push(s?e.call(t,h.js[f]):e(h.js[f]))}catch(p){h.results.push(undefined);h.errors.push({index:f,error:p,js:h.js[f]})}}}}return a?h:l?h.results:h.results[0]}}function l(e,r,i){var s=n.newId("sandbox");e=e===null?"":' sandbox="'+(e?e:"allow-scripts")+'"';(i||t.body||t.head||t.getElementsByTagName("head")[0]).insertAdjacentHTML("afterbegin",'<iframe src="'+r+'" id="'+s+'" style="display:none;"'+e+"></iframe>");return t.getElementById(s)}function c(t,s,h){var p,d="eval",v=s!==undefined&&s!==null;s=v?s:e;switch(t){case"g":{if(s===e){a();p=!u&&h.f?r:u;if(p){return f(p,e)}}else if(n.is.fn(s[d])){p=s[d]("(function(){"+a(true)+"})()");p=!p&&h.f?function(){return s[d](arguments[0])}:p;if(p){return h.r?p:f(p,s)}}break};case"l":{return f(r,s,v)};case"u":{return f(i,s,v)};case"i":{h=n.is.obj(h)?h:{};h.iframe=l(null,"");h.window=h.iframe.contentWindow;p=c("g",h.window,{f:1,r:1});return f(p,v?s:h.window,v)};case"j":{return f(o)}}}var o,u=null;if(e.JSON&&e.JSON.parse){o=e.JSON.parse}else if(e.jQuery&&e.jQuery.parseJSON){o=e.jQuery.parseJSON}return{version:n.version,global:function(t,n){return c("g",n||e,{f:t})},local:!r?undefined:function(e){return c("l",e)},useStrict:!i?undefined:function(e){return c("u",e)},isolated:function(e,t){return c("i",e,t)},json:!o?undefined:function(){return c("j")},sandbox:!s?undefined:s(e,n,{looper:f,iframe:l})}},function(){if(arguments[2]){while(arguments[2].k.length>0){eval("var "+arguments[2].k.shift()+"=arguments[2].o[arguments[1]];")}}while(arguments[1]<arguments[0].js.length){try{eval(arguments[0].js[arguments[1]])}catch(e){arguments[0].results.push(undefined);arguments[0].errors.push({index:arguments[1],error:e,js:arguments[0].js[arguments[1]]})}arguments[1]++}},function(){if(arguments[2]){while(arguments[2].k.length>0){eval("var "+arguments[2].k.shift()+"=arguments[2].o[arguments[1]];")}}(function(){"use strict";while(arguments[1]<arguments[0].js.length){try{eval(arguments[0].js[arguments[1]])}catch(e){arguments[0].results.push(undefined);arguments[0].errors.push({index:arguments[1],error:e,js:arguments[0].js[arguments[1]]})}arguments[1]++}})(arguments[0],0,arguments[2])},function(e,t,n){"use strict";function u(n,u){var a=arguments[3];if(!s){s=true;e.addEventListener=e.addEventListener||function(t,n){e.attachEvent("on"+t,n)};e.addEventListener("message",function(n){var s;i=t.is.str(n.data);if(n.origin==="null"&&r[s.id]){s=i?e.JSON.parse(n.data):n.data;r[s.id](n.source,{results:s.r,errors:s.e,js:s.js},s.arg);delete r[s.id]}},false);try{e.postMessage({},"*")}catch(f){i=true}}return function(s,f,l){var c=t.is.arr(s);return{then:function(t,h){var p={js:c?s:[s],id:o++,arg:h,type:n,context:u,inject:f};r[o]=function(e,n,r){if(e===a){t(l?n:c?n.results:n.results[0],r)}};a.postMessage(i?e.JSON.stringify(p):p,"*")}}}}function a(t){var r=t.contentWindow,i=e.postMessage&&(t.getAttribute("sandbox")+"").indexOf("allow-same-origin")===-1,s=i?u:n.looper;return{iframe:t,window:r,secure:i,global:function(e){var t=e?"isolated":"global";return s(i?t:r.$sandbox[t],r)},local:function(e){var t=arguments.length===1,n=t?"context":"local";return s(i?n:r.$sandbox[n],e||r,t,r)}}}var r=[],i=false,s=false,o=0;return function(e,t,r){switch(arguments.length){case 1:{a(e);break};case 2:case 3:{a(n.iframe(e,t,r));break}}}})
